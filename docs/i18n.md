# Internationalization (i18n)

Provided via [i18next](https://www.i18next.com/) + [react-i18next](https://react.i18next.com/), it's already configured to work without having to do anything (apart from configuring what languages are supported...)

On development mode, i18n locale .json files are also updated on real time thanks to [i18next-hmr](https://github.com/felixmosh/i18next-hmr).

## Configuration

Locales are placed in [/resources/locales/[LANG]/](../resources/locales/).

As they follow `i18next` conventions, usually each locale will have its own folder and then translation can be divided on namespaces by placing them in different json files.

In the [i18n/constants](../src/shared/i18n/constants.ts) file, edit the available constants to provide the desired configuration (default and every available language, initial namespaces to load, etc.)

## Usage

### Renderer + React

`i18next` uses `React.Suspense` by default. This means that unless the translations are pre-loaded explicitly, components using translations need to be wrapped in `<Suspense>` to avoid errors.

(Note that translations are loaded via IPC from the same machine meaning that even if the load is done asynchronously, it's super fast! But there's always the chance of components being rendered when the translations are not available, even if it's just for 1ms)

There are several ways to handle this easily:

#### Standard React

The standard way to do it with React would be:

```tsx
// my-component.tsx
import { FC, Suspense } from 'react';

export const MyComponent: FC<Props> = (props) => {
  return (
    <Suspense fallback="loading...">
      <Content {...props} />
    </Suspense>
  );
};

const Content: FC<Props> = (props) => {
  return (
    ...
  )
};
```

#### WithSuspense HoC

There's an _easier_ way to write the same without having to split the exported component using `Content` so it can be wrapped with `Suspense`:

```tsx
// my-component.tsx
import { FC } from 'react';
import { WithSuspense } from '@/shared/i18n';

export const MyComponent: FC<Props> = WithSuspense((props) => {
  return (
    ...
  )
}, 'loading...');
```

#### Preloading explicit namespaces

If for any reason the namespaces need to be explicitly preloaded and display the content after the load is finished, it can be done as well using `<PreloadI18nNs>`:

```tsx
// my-component.tsx
import { FC } from 'react';
import { PreloadI18nNs } from '@/shared/i18n';

export const MyComponent: FC<Props> = (props) => {
  return (
    <PreloadI18nNs ns="translations" fallback="loading...">
      ...
    </PreloadI18nNs>
  );
};
```

or using the HoC version via `WithI18nNs`:

```tsx
import { FC } from 'react';
import { WithI18nNs } from '@/shared/i18n';

export const MyComponent = WithI18nNs(
  {
    ns: 'translations',
    fallback: 'loading...'
  },
  (props) => {
    return (
      ...
    )
  }
);
```
